expenditure_tables <- expenditure_url %>%
read_html() %>%
html_table()
table3 <- expenditure_tables[[3]]
table4 <- expenditure_tables[[4]]
US_expenditure_data <- table3 %>%
left_join(table4, by=c('Country'='Country'))
US_expenditure_data <- US_expenditure_data %>%
slice(18) %>%
select(-c(1))
US_expenditure_data <- US_expenditure_data %>%
pivot_longer(c(1:20))
US_expenditure_data <- US_expenditure_data %>%
rename("Year" = "name", "Millions_of_dollars" = "value") %>%
slice(-c(1:8))
US_expenditure_data$Millions_of_dollars <- gsub(",","",US_expenditure_data$Millions_of_dollars)
US_expenditure_data <- as.data.frame(apply(US_expenditure_data, 2, as.numeric))
US_expenditure_data <- US_expenditure_data %>%
mutate(
delta_expenditure = Millions_of_dollars - lag(Millions_of_dollars),
percentage_delta_expenditure = (Millions_of_dollars - lag(Millions_of_dollars)) / Millions_of_dollars * 100
)
US_expenditure_data[is.na(US_expenditure_data)] = 0
military_presence_total_active_reserve <- military_presence %>%
group_by(Year) %>%
summarize(
total_active = sum(Army_Active_Duty) + sum(Navy_Active_Duty) + sum(Marine_Corps_Active_Duty) + sum(Air_Force_Active_Duty) + sum(Coast_Guard_Active_Duty),
total_reserve = sum(Army_Reserve) + sum(Navy_Reserve) + sum(Marine_Corps_Reserve) + sum(Air_Force_Reserve) + sum(Coast_Guard_Reserve)
) %>%
select(Year, total_active, total_reserve)
military_presence_total_active_reserve <- military_presence_total_active_reserve %>%
mutate(
delta_active = total_active - lag(total_active),
delta_reserve = total_reserve - lag(total_reserve),
percentage_delta_active = (total_active - lag(total_active)) / total_active * 100,
percentage_delta_reserve = (total_reserve - lag(total_reserve)) / total_reserve * 100
)
military_presence_total_active_reserve[is.na(military_presence_total_active_reserve)] = 0
expenditure_vs_total_military <- military_presence_total_active_reserve %>%
left_join(US_expenditure_data, by = c('Year'))
expenditure_vs_total_military <- expenditure_vs_total_military %>%
slice(1:12) %>%
select(Year, percentage_delta_active, percentage_delta_reserve, percentage_delta_expenditure)
ggplot() +
geom_line(
data = expenditure_vs_total_military,
aes(x = Year,
y = percentage_delta_active,
color = "blue")
) +
geom_line(
data = expenditure_vs_total_military,
aes(x = Year,
y = percentage_delta_reserve,
color = "red")
) +
geom_line(
data = expenditure_vs_total_military,
aes(x = Year,
y = percentage_delta_expenditure)
)
military_presence_2021 <- military_presence %>%
filter(Year == 2021)
military_presence_total_active_2021 <- military_presence_2021 %>%
group_by(Location, Date) %>%
summarize(
total_active = sum(Army_Active_Duty) + sum(Navy_Active_Duty) + sum(Marine_Corps_Active_Duty) + sum(Air_Force_Active_Duty) + sum(Coast_Guard_Active_Duty)
) %>%
select(Location, Date, total_active) %>%
arrange(Location, Date, .by_group = TRUE)
military_presence_total_active_2021 <- military_presence_total_active_2021[-1,]
military_presence_active_delta_2021 <- military_presence_total_active_2021 %>%
mutate(delta = total_active - lag(total_active)) %>%
select(-total_active)
military_presence_active_delta_2021[is.na(military_presence_active_delta_2021)] = 0
military_presence_active_delta_2021 <- military_presence_active_delta_2021 %>%
filter(Date == "2021-12-01") %>%
arrange(desc(delta))
view(military_presence_active_delta_2021)
knitr::opts_chunk$set(echo = TRUE)
# Turn off scientific notation
options(scipen=999)
library(tidyverse)
library(lubridate)
library(tidycensus)
library(tigris)
library(sf)
library(filenamer)
census_api_key("549950d36c22ff16455fe196bbbd01d63cfbe6cf")
crime_log <- read_csv("https://raw.githubusercontent.com/dwillis/wvu-projects/master/crime-log/crime_log.csv")
crime_log <- crime_log %>%
mutate(
date = mdy_hm(datetime, tz= "EST"),
hour = hour(date)
)
crime_log <- crime_log %>%
mutate(
date = as.Date(date)
)
crime_log <- crime_log %>%
mutate(
day_of_week = wday(date, label = TRUE, abbr = FALSE)
)
crime_log_recent_incidents <- crime_log %>%
filter(date == today() - days(1))
vehicle_accidents_last_month <- crime_log %>%
filter(between(date, today() - days(30), today())) %>%
group_by(title) %>%
summarize(
total_vehicular_accidents = n()
) %>%
filter(title == "VEHICLE ACCIDENT")
sub <- paste("There were ", vehicle_accidents_last_month$total_vehicular_accidents, " ", str_to_lower(vehicle_accidents_last_month$title), "s in the last month, the most recent occurring on ", month(today(), label = TRUE, abbr = FALSE), " ", day(today() - days(1)), ", ", year(today()), ". Is this an increase or decrease from previous months?", sep="")
sub
vax_zip_code <- read_csv("https://raw.githubusercontent.com/state-of-maryland/VaccineCSVs/master/Vax_ZIP_CODE_FirstSecondSingle_Totals_Raw.csv")
vax_zip_code <- vax_zip_code %>%
mutate(
zip = ZIP_CODE,
first_dose = FirstDose,
second_dose = SecondDose,
single_dose = SingleDose,
at_least_one_dose = AtleastOneDose,
fully_vaccinated = FullyVaccinated,
date = today()
) %>%
select(
zip,
first_dose,
second_dose,
single_dose,
at_least_one_dose,
fully_vaccinated,
date
)
vax_zip_code <- vax_zip_code %>%
drop_na(fully_vaccinated) %>%
filter(between(zip, 10000, 99999))
maryland_zips <- vax_zip_code %>%
filter(between(zip, 20601, 21930))
maryland_zips_vax <- maryland_zips %>%
arrange(desc(fully_vaccinated)) %>%
head(25)
non_maryland_zips <- vax_zip_code %>%
filter(!between(zip,20601, 21930))
non_maryland_zips_vax <- vax_zip_code %>%
arrange(desc(fully_vaccinated)) %>%
head(25)
st=format(Sys.time(), "%Y%m%d")
md_csv <- paste("maryland_zips_",st, ".csv", sep = "")
nonmd_csv <- paste("non_maryland_zips_",st, ".csv", sep ="")
write_csv(maryland_zips, md_csv)
write_csv(non_maryland_zips, nonmd_csv)
sub <- paste("The two zip codes with the highest fully vaccinated population in Maryland are ", maryland_zips$zip[1], " and ", maryland_zips_vax$zip[2], ". The two zip codes with the highest fully vaccinated population outside of Maryland are ", non_maryland_zips_vax$zip[1], " and ", non_maryland_zips$zip[2], ".", sep="")
sub
# The top two zip codes of April 21, 2022, in Maryland reside in Montgomery County, and encompass Aspen Hill, Gaithersburg, North Potomac an Darnestown. The top two zip codes of the same date outside of Maryland are both in Washington, D.C.
md_zip_population <- get_acs(geography = "zcta",
variables = c(population = "B01001_001"),
state = "MD",
geometry = TRUE)
md_zip_population <- md_zip_population %>%
select(GEOID, estimate, geometry) %>%
rename(
zip = GEOID,
population = estimate
) %>%
mutate(
zip = as.numeric(zip)
)
md_zip_vax_pop <- md_zip_population %>%
left_join(maryland_zips, zip = zip)
md_zip_vax_pop <- md_zip_vax_pop %>%
mutate(
percent_fully_vaccinated = fully_vaccinated / population * 100
) %>%
filter(percent_fully_vaccinated < 50)
covid <- read_csv("https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv")
head(covid)
maryland <- covid %>% filter(state == "Maryland")
current <- maryland %>% summarize(max(date))
marylandcurrent <- maryland %>% filter(date == current[[1]]) %>% rename(GEOID = fips)
counties <- st_read("data/cb_2018_us_county_5m/cb_2018_us_county_5m.shp")
counties <- counties %>% left_join(marylandcurrent)
mdcounties <- counties %>% filter(STATEFP == 24)
ggplot() +
geom_sf(data=mdcounties, aes()) +
geom_sf(data=md_zip_vax_pop, aes(fill=percent_fully_vaccinated)) +
scale_fill_viridis_c(option = "plasma", trans = "sqrt") +
theme_void() +
labs(title = paste("Areas less than 50% vaccinated, as of ", current[[1]], sep=""))
#Rural areas, especially in the Appalachian Mountains or along Eastern Shoore, appear to be the least vaccinated, but there aren't specifically any areas that are strictly unvaccinated. A majority of Maryland is at least 50% vaccinated.
map <- read_csv("https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv")
View(crime_log_recent_incidents)
head(map)
maryland <- map %>% filter(state == "Maryland")
current <- maryland %>% summarize(max(date))
marylandcurrent <- maryland %>% filter(date == current[[1]]) %>% rename(GEOID = fips)
counties <- counties %>% left_join(marylandcurrent)
ggplot() +
geom_sf(data=mdcounties, aes()) +
geom_sf(data=md_zip_vax_pop, aes(fill=percent_fully_vaccinated)) +
scale_fill_viridis_c(option = "plasma", trans = "sqrt") +
theme_void() +
labs(title = paste("Areas less than 50% vaccinated, as of ", current[[1]], sep=""))
crime_log <- read_csv("https://raw.githubusercontent.com/dwillis/wvu-projects/master/crime-log/crime_log.csv")
crime_log <- crime_log %>%
mutate(
date = mdy_hm(datetime, tz= "EST"),
hour = hour(date)
)
crime_log <- crime_log %>%
mutate(
date = as.Date(date)
)
crime_log <- crime_log %>%
mutate(
day_of_week = wday(date, label = TRUE, abbr = FALSE)
)
crime_log_recent_incidents <- crime_log %>%
filter(date == today() - days(1))
View(crime_log_recent_incidents)
View(crime_log)
crime_log_recent_incidents <- crime_log %>%
filter(date == today() - days(1))
View(crime_log_recent_incidents)
crime_log_recent_incidents <- crime_log %>%
arrange(desc(date)) %>%
slice(1)
crime_log_recent_incidents <- crime_log %>%
arrange(desc(datetime)) %>%
slice(1)
crime_log <- crime_log %>%
mutate(
day_of_week = wday(date, label = TRUE, abbr = FALSE)
)
crime_log_recent_incidents <- crime_log %>%
arrange(desc(datetime)) %>%
slice(1)
crime_log_recent_incidents <- crime_log %>%
arrange(desc(date)) %>%
slice(1)
vehicle_accidents_last_month <- crime_log %>%
filter(between(date, today() - days(30), today())) %>%
group_by(title) %>%
summarize(
total_incident = n()
) %>%
filter(title == crime_log_recent_incidents$title)
incidents_last_month <- crime_log %>%
filter(between(date, today() - days(30), today())) %>%
group_by(title) %>%
summarize(
total_incident = n()
) %>%
filter(title == crime_log_recent_incidents$title)
View(incidents_last_month)
crime_log <- read_csv("https://raw.githubusercontent.com/dwillis/wvu-projects/master/crime-log/crime_log.csv")
crime_log <- crime_log %>%
mutate(
date = mdy_hm(datetime, tz= "EST"),
hour = hour(date)
)
crime_log <- crime_log %>%
mutate(
date = as.Date(date)
)
crime_log <- crime_log %>%
mutate(
day_of_week = wday(date, label = TRUE, abbr = FALSE)
)
crime_log_recent_incidents <- crime_log %>%
arrange(desc(date)) %>%
slice(1)
incidents_last_month <- crime_log %>%
filter(between(date, today() - days(30), today())) %>%
group_by(title) %>%
summarize(
total_incidents = n()
) %>%
filter(title == crime_log_recent_incidents$title)
sub <- paste("There were ", incidents_last_month$total_incidents, " ", str_to_lower(incidents_last_month$title), "s in the last month, the most recent occurring on ", month(today(), label = TRUE, abbr = FALSE), " ", day(today() - days(1)), ", ", year(today()), ". Is this an increase or decrease from previous months?", sep="")
sub
sub <- paste("There were ", incidents_last_month$total_incidents, " ", str_to_lower(incidents_last_month$title), "s in the last month, the most recent occurring on ", month(today(), label = TRUE, abbr = FALSE), " ", day(crime_log_recent_incidents$date), ", ", year(today()), ". Is this an increase or decrease from previous months?", sep="")
sub
md_zip_population <- get_acs(geography = "zcta",
variables = c(population = "B01001_001"),
state = "MD",
geometry = TRUE)
md_zip_population <- md_zip_population %>%
select(GEOID, estimate, geometry) %>%
rename(
zip = GEOID,
population = estimate
) %>%
mutate(
zip = as.numeric(zip)
)
md_zip_vax_pop <- md_zip_population %>%
left_join(maryland_zips, zip = zip)
md_zip_vax_pop <- md_zip_vax_pop %>%
mutate(
percent_fully_vaccinated = fully_vaccinated / population * 100
) %>%
filter(percent_fully_vaccinated < 50)
# I used the COVID map from Nytimes because it looked a lot cleaner and more like the state of Maryland than the map from the census.
map <- read_csv("https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv")
View(maryland_zips)
View(maryland_zips)
head(map)
maryland <- map %>% filter(state == "Maryland")
current <- maryland %>% summarize(max(date))
marylandcurrent <- maryland %>% filter(date == current[[1]]) %>% rename(GEOID = fips)
counties <- st_read("data/cb_2018_us_county_5m/cb_2018_us_county_5m.shp")
counties <- counties %>% left_join(marylandcurrent)
mdcounties <- counties %>% filter(STATEFP == 24)
ggplot() +
geom_sf(data=mdcounties, aes()) +
geom_sf(data=md_zip_vax_pop, aes(fill=percent_fully_vaccinated)) +
scale_fill_viridis_c(option = "plasma", trans = "sqrt") +
theme_void() +
labs(title = paste("Areas less than 50% vaccinated, as of ", current[[1]], sep=""))
#Rural areas, especially in the Appalachian Mountains or along Eastern Shoore, appear to be the least vaccinated, but there aren't specifically any areas that are strictly unvaccinated. A majority of Maryland is at least 50% vaccinated.
sub <- paste("The two zip codes with the highest fully vaccinated population in Maryland are ", maryland_zips$zip[1], " and ", maryland_zips_vax$zip[2], ". The two zip codes with the highest fully vaccinated population outside of Maryland are ", non_maryland_zips_vax$zip[1], " and ", non_maryland_zips$zip[2], ".", sep="")
sub
knitr::opts_chunk$set(echo = TRUE)
# Turn off scientific notation
options(scipen=999)
library(tidyverse)
library(lubridate)
library(janitor)
library(rvest)
military_presence <- read_csv("military_presence.csv")
setwd("~/GitHub/military_presence/deliverable_04")
military_presence <- read_csv("military_presence.csv")
military_presence <- military_presence %>%
mutate(
Year = year(Date)
)
knitr::opts_chunk$set(echo = TRUE)
# Turn off scientific notation
options(scipen=999)
library(tidyverse)
library(lubridate)
library(janitor)
library(rvest)
military_presence <- read_csv("military_presence.csv")
military_presence <- military_presence %>%
mutate(
Year = year(Date)
)
obama_08_and_16 <- military_presence %>%
filter(Year == "2008" | Year == "2016")%>%
group_by(Location, Year)%>%
summarize(
total_active = sum(Army_Active_Duty) + sum(Navy_Active_Duty) + sum(Marine_Corps_Active_Duty) + sum(Air_Force_Active_Duty) + sum(Coast_Guard_Active_Duty))
obama_08_and_16 <- obama_08_and_16%>%
arrange(Location,Year, .by_group = TRUE)%>%
mutate(change= total_active - lag(total_active))%>%
arrange(desc(change))
expenditure_url <- "https://en.wikipedia.org/wiki/Past_military_expenditure_by_country"
expenditure_tables <- expenditure_url %>%
read_html() %>%
html_table()
table3 <- expenditure_tables[[3]]
table4 <- expenditure_tables[[4]]
US_expenditure_data <- table3 %>%
left_join(table4, by=c('Country'='Country'))
US_expenditure_data <- US_expenditure_data %>%
slice(18) %>%
select(-c(1))
US_expenditure_data <- US_expenditure_data %>%
pivot_longer(c(1:20))
US_expenditure_data <- US_expenditure_data %>%
rename("Year" = "name", "Millions_of_dollars" = "value") %>%
slice(-c(1:8))
US_expenditure_data$Millions_of_dollars <- gsub(",","",US_expenditure_data$Millions_of_dollars)
US_expenditure_data <- as.data.frame(apply(US_expenditure_data, 2, as.numeric))
US_expenditure_data <- US_expenditure_data %>%
mutate(
delta_expenditure = Millions_of_dollars - lag(Millions_of_dollars),
percentage_delta_expenditure = (Millions_of_dollars - lag(Millions_of_dollars)) / Millions_of_dollars * 100
)
US_expenditure_data[is.na(US_expenditure_data)] = 0
military_presence_total_active_reserve <- military_presence %>%
group_by(Year) %>%
summarize(
total_active = sum(Army_Active_Duty) + sum(Navy_Active_Duty) + sum(Marine_Corps_Active_Duty) + sum(Air_Force_Active_Duty) + sum(Coast_Guard_Active_Duty),
total_reserve = sum(Army_Reserve) + sum(Navy_Reserve) + sum(Marine_Corps_Reserve) + sum(Air_Force_Reserve) + sum(Coast_Guard_Reserve)
) %>%
select(Year, total_active, total_reserve)
military_presence_total_active_reserve <- military_presence_total_active_reserve %>%
mutate(
delta_active = total_active - lag(total_active),
delta_reserve = total_reserve - lag(total_reserve),
percentage_delta_active = (total_active - lag(total_active)) / total_active * 100,
percentage_delta_reserve = (total_reserve - lag(total_reserve)) / total_reserve * 100
)
military_presence_total_active_reserve[is.na(military_presence_total_active_reserve)] = 0
expenditure_vs_total_military <- military_presence_total_active_reserve %>%
left_join(US_expenditure_data, by = c('Year'))
expenditure_vs_total_military <- expenditure_vs_total_military %>%
slice(1:12) %>%
select(Year, percentage_delta_active, percentage_delta_reserve, percentage_delta_expenditure)
ggplot() +
geom_line(
data = expenditure_vs_total_military,
aes(x = Year,
y = percentage_delta_active,
color = "blue")
) +
geom_line(
data = expenditure_vs_total_military,
aes(x = Year,
y = percentage_delta_reserve,
color = "red")
) +
geom_line(
data = expenditure_vs_total_military,
aes(x = Year,
y = percentage_delta_expenditure)
)
military_presence_2021 <- military_presence %>%
filter(Year == 2021)
military_presence_total_active_2021 <- military_presence_2021 %>%
group_by(Location, Date) %>%
summarize(
total_active = sum(Army_Active_Duty) + sum(Navy_Active_Duty) + sum(Marine_Corps_Active_Duty) + sum(Air_Force_Active_Duty) + sum(Coast_Guard_Active_Duty)
) %>%
select(Location, Date, total_active) %>%
arrange(Location, Date, .by_group = TRUE)
military_presence_total_active_2021 <- military_presence_total_active_2021[-1,]
military_presence_active_delta_2021 <- military_presence_total_active_2021 %>%
mutate(delta = total_active - lag(total_active)) %>%
select(-total_active)
military_presence_active_delta_2021[is.na(military_presence_active_delta_2021)] = 0
military_presence_active_delta_2021 <- military_presence_active_delta_2021 %>%
filter(Date == "2021-12-01") %>%
arrange(desc(delta))
view(military_presence_active_delta_2021)
military_presence_unknown <- military_presence %>%
filter(Location == "UNKNOWN" | Location == "ZZ-UNKNOWN")
View(military_presence_unknown)
summarize(
total_personnel = sum(c_across(3:20))
)
military_presence_unknown <- military_presence %>%
filter(Location == "UNKNOWN" | Location == "ZZ-UNKNOWN") %>%
group_by(Year)
summarize(
total_personnel = sum(c_across(3:20))
)
military_presence_unknown <- military_presence %>%
filter(Location == "UNKNOWN" | Location == "ZZ-UNKNOWN") %>%
group_by(Year)
summarize(
total_personnel = rowSums(across(3:20))
)
military_presence_unknown <- military_presence %>%
filter(Location == "UNKNOWN" | Location == "ZZ-UNKNOWN") %>%
group_by(Year) %>%
summarize(
total_personnel = sum(c_across(3:20))
)
military_presence_unknown <- military_presence %>%
filter(Location == "UNKNOWN" | Location == "ZZ-UNKNOWN") %>%
group_by(Year) %>%
summarize(
total_personnel = sum(c_across(3:19))
)
military_presence_unknown <- military_presence %>%
filter(Location == "UNKNOWN" | Location == "ZZ-UNKNOWN") %>%
group_by(Year) %>%
summarize(
total_unknown_personnel = sum(c_across(3:19))
)
military_presence_unknown <- military_presence %>%
filter(Location == "UNKNOWN" | Location == "ZZ-UNKNOWN") %>%
group_by(Year) %>%
summarize(
total_unknown_personnel = sum(c_across(3:19))
)
ggplot() +
geom_line(
data = military_presence_unknown,
aes(
x = Year,
y = total_unknown_personnel
)
)
knitr::opts_chunk$set(echo = TRUE)
# Turn off scientific notation
options(scipen=999)
library(tidyverse)
library(readxl)
library(lubridate)
library(dplyr)
military_presence <- read_csv("military_presence.csv")
military_presence <- military_presence %>%
mutate(
Date = mdy(Date),
Year = year(Date)
)
military_active <- military_presence %>%
filter(Year == 2021 & US_Or_Overseas == "OS")%>%
group_by(Location)%>%
summarize(
total_active = sum(Army_Active_Duty) + sum(Navy_Active_Duty) + sum(Marine_Corps_Active_Duty) + sum(Air_Force_Active_Duty) + sum(Coast_Guard_Active_Duty))%>%
arrange(total_active)
military_per_100K <- read_csv("population.csv")%>%
inner_join(military_active, by=c ("Location"))%>%
mutate(military_per_100K = total_active/Population*100000)%>%
arrange(desc(military_per_100K))
View(military_per_100K)
